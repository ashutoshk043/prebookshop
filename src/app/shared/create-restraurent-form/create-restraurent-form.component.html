<!-- Bootstrap Modal -->
<div class="modal fade" #restaurantModal tabindex="-1" aria-labelledby="restaurantModalLabel" aria-hidden="true">
  <div class="modal-dialog modal-xl modal-dialog-centered modal-dialog-scrollable">
    <div class="modal-content">

      <!-- Modal Header -->
      <div class="modal-header bg-primary text-white">
        <h5 class="modal-title" id="restaurantModalLabel">
          <i class="bi bi-shop me-2"></i>
          {{ formMode === 'add' ? 'Add New Restaurant' : 'Edit Restaurant' }}
        </h5>
        <button type="button" class="btn-close btn-close-white" (click)="closeForm()" aria-label="Close"></button>
      </div>

      <!-- Modal Body -->
      <div class="modal-body p-4">
        <form [formGroup]="restaurantForm" (ngSubmit)="onSubmitRestaurant()">

          <!-- Basic Information -->
          <div class="row mb-3">
            <div class="col-md-6 mb-3 mb-md-0">
              <label for="restaurantName" class="form-label fw-semibold">
                Restaurant Name <span class="text-danger">*</span>
              </label>
              <input type="text" class="form-control" id="restaurantName" formControlName="restaurantName"
                [class.is-invalid]="f['restaurantName'].invalid && f['restaurantName'].touched">
              <div class="invalid-feedback" *ngIf="f['restaurantName'].invalid && f['restaurantName'].touched">
                Restaurant name is required
              </div>
            </div>


            <div class="col-md-6">
              <label for="restaurantType" class="form-label fw-semibold">
                Restaurant Type <span class="text-danger">*</span>
              </label>
              <select class="form-select" id="restaurantType" formControlName="restaurantType"
                [class.is-invalid]="f['restaurantType'].invalid && f['restaurantType'].touched">
                <option value="">Select Type</option>
                <option value="fine-dining">Fine Dining</option>
                <option value="casual-dining">Casual Dining</option>
                <option value="quick-service">Quick Service</option>
                <option value="fast-food">Fast Food</option>
                <option value="cafe">Cafe</option>
                <option value="cloud-kitchen">Cloud Kitchen</option>
              </select>
              <div class="invalid-feedback" *ngIf="f['restaurantType'].invalid && f['restaurantType'].touched">
                Please select a restaurant type
              </div>
            </div>
          </div>

          <div class="mb-3">
            <label class="form-label fw-semibold">
              Owner Email <span class="text-danger">*</span>
            </label>

            <ng-select [items]="ownerEmailList" bindLabel="email" bindValue="id" placeholder="Search owner email"
              formControlName="ownerEmail" [searchable]="true" (search)="onOwnerSearch($event)"
              [class.is-invalid]="f['ownerEmail'].invalid && f['ownerEmail'].touched">
            </ng-select>

            <div class="invalid-feedback d-block" *ngIf="f['ownerEmail'].invalid && f['ownerEmail'].touched">
              Owner email is required
            </div>
          </div>




          <!-- Address -->
          <div class="mb-3">
            <label for="restaurantAddress" class="form-label fw-semibold">
              Restaurant Address <span class="text-danger">*</span>
            </label>
            <input type="text" class="form-control" id="restaurantAddress" formControlName="restaurantAddress"
              [class.is-invalid]="f['restaurantAddress'].invalid && f['restaurantAddress'].touched">
            <div class="invalid-feedback" *ngIf="f['restaurantAddress'].invalid && f['restaurantAddress'].touched">
              Address is required
            </div>
          </div>

          <!-- Location Details -->
          <div class="row mb-3">
            <div class="col-md-4 mb-3 mb-md-0">
              <label for="pincode" class="form-label fw-semibold">
                Pincode <span class="text-danger">*</span>
              </label>
              <input type="text" class="form-control" id="pincode" formControlName="pincode" maxlength="6"
                [class.is-invalid]="f['pincode'].invalid && f['pincode'].touched">
              <div class="invalid-feedback" *ngIf="f['pincode'].invalid && f['pincode'].touched">
                <span *ngIf="f['pincode'].errors?.['required']">Pincode is required</span>
                <span *ngIf="f['pincode'].errors?.['pattern']">Must be 6 digits</span>
              </div>
            </div>

            <div class="col-md-4 mb-3 mb-md-0">
              <label for="latitude" class="form-label fw-semibold">
                Latitude <span class="text-danger">*</span>
              </label>
              <input type="text" class="form-control" id="latitude" formControlName="latitude"
                [class.is-invalid]="f['latitude'].invalid && f['latitude'].touched">
              <div class="invalid-feedback" *ngIf="f['latitude'].invalid && f['latitude'].touched">
                Latitude is required
              </div>
            </div>

            <div class="col-md-4">
              <label for="longitude" class="form-label fw-semibold">
                Longitude <span class="text-danger">*</span>
              </label>
              <input type="text" class="form-control" id="longitude" formControlName="longitude"
                [class.is-invalid]="f['longitude'].invalid && f['longitude'].touched">
              <div class="invalid-feedback" *ngIf="f['longitude'].invalid && f['longitude'].touched">
                Longitude is required
              </div>
            </div>
          </div>

          <!-- Get Current Location Button -->
          <div class="row mb-3">
            <div class="col-12">
              <button type="button" class="btn btn-outline-primary btn-sm" (click)="getCurrentLocation()">
                <i class="bi bi-geo-alt-fill me-1"></i>
                Use My Current Location
              </button>
              <small class="text-muted ms-2">Click to auto-fill latitude and longitude</small>
            </div>
          </div>

          <!-- Legal Information -->
          <div class="row mb-3">
            <div class="col-md-4 mb-3 mb-md-0">
              <label for="fssaiNumber" class="form-label fw-semibold">
                FSSAI Number <span class="text-danger">*</span>
              </label>
              <input type="text" class="form-control" id="fssaiNumber" formControlName="fssaiNumber"
                [class.is-invalid]="f['fssaiNumber'].invalid && f['fssaiNumber'].touched">
              <div class="invalid-feedback" *ngIf="f['fssaiNumber'].invalid && f['fssaiNumber'].touched">
                FSSAI number is required
              </div>
            </div>

            <div class="col-md-4 mb-3 mb-md-0">
              <label for="gstNumber" class="form-label fw-semibold">
                GST Number
              </label>
              <input type="text" class="form-control text-uppercase" id="gstNumber" formControlName="gstNumber"
                maxlength="15" [class.is-invalid]="f['gstNumber'].invalid && f['gstNumber'].touched">
              <div class="invalid-feedback" *ngIf="f['gstNumber'].invalid && f['gstNumber'].touched">
                <span *ngIf="f['gstNumber'].errors?.['pattern']">Invalid GST format</span>
              </div>
            </div>

            <!-- <div class="col-md-4">
              <label for="panNumber" class="form-label fw-semibold">
                PAN Number <span class="text-danger">*</span>
              </label>
              <input type="text" class="form-control text-uppercase" id="panNumber" formControlName="panNumber"
                maxlength="10" [class.is-invalid]="f['panNumber'].invalid && f['panNumber'].touched">
              <div class="invalid-feedback" *ngIf="f['panNumber'].invalid && f['panNumber'].touched">
                <span *ngIf="f['panNumber'].errors?.['required']">PAN number is required</span>
                <span *ngIf="f['panNumber'].errors?.['pattern']">Invalid PAN format</span>
              </div>
            </div> -->
          </div>

          <!-- Timing Details -->
          <div class="row mb-3">
            <div class="col-md-4 mb-3 mb-md-0">
              <label for="registrationDate" class="form-label fw-semibold">
                Registration Date <span class="text-danger">*</span>
              </label>
              <input type="date" class="form-control" formControlName="registrationDate" readonly />

            </div>

            <div class="col-md-4 mb-3">
              <label class="form-label fw-semibold">
                Opening Time <span class="text-danger">*</span>
              </label>

              <div class="input-group">
                <select class="form-select" formControlName="openingHour">
                  <option value="">HH</option>
                  <option *ngFor="let h of hours" [value]="h">{{ h }}</option>
                </select>

                <select class="form-select" formControlName="openingMinute">
                  <option value="">MM</option>
                  <option *ngFor="let m of minutes" [value]="m">{{ m }}</option>
                </select>

                <select class="form-select" formControlName="openingPeriod">
                  <option value="">AM/PM</option>
                  <option value="AM">AM</option>
                  <option value="PM">PM</option>
                </select>
              </div>

              <div class="invalid-feedback d-block" *ngIf="f['openingHour'].invalid && f['openingHour'].touched">
                Opening time is required
              </div>
            </div>


            <div class="col-md-4 mb-3">
              <label class="form-label fw-semibold">
                Closing Time <span class="text-danger">*</span>
              </label>

              <div class="input-group">
                <select class="form-select" formControlName="closingHour">
                  <option value="">HH</option>
                  <option *ngFor="let h of hours" [value]="h">{{ h }}</option>
                </select>

                <select class="form-select" formControlName="closingMinute">
                  <option value="">MM</option>
                  <option *ngFor="let m of minutes" [value]="m">{{ m }}</option>
                </select>

                <select class="form-select" formControlName="closingPeriod">
                  <option value="">AM/PM</option>
                  <option value="AM">AM</option>
                  <option value="PM">PM</option>
                </select>
              </div>

              <div class="invalid-feedback d-block" *ngIf="f['closingHour'].invalid && f['closingHour'].touched">
                Closing time is required
              </div>
            </div>

          </div>

          <!-- Images -->
          <div class="row mb-3">
            <div class="col-md-6 mb-3 mb-md-0">
              <label for="logoUrl" class="form-label fw-semibold">Logo URL</label>
              <input type="url" class="form-control" id="logoUrl" formControlName="logoUrl"
                placeholder="https://example.com/logo.png"
                [class.is-invalid]="f['logoUrl'].invalid && f['logoUrl'].touched">
              <div class="invalid-feedback" *ngIf="f['logoUrl'].invalid && f['logoUrl'].touched">
                Please enter a valid URL
              </div>
            </div>

            <div class="col-md-6">
              <label for="coverImageUrl" class="form-label fw-semibold">Cover Image URL</label>
              <input type="url" class="form-control" id="coverImageUrl" formControlName="coverImageUrl"
                placeholder="https://example.com/cover.jpg"
                [class.is-invalid]="f['coverImageUrl'].invalid && f['coverImageUrl'].touched">
              <div class="invalid-feedback" *ngIf="f['coverImageUrl'].invalid && f['coverImageUrl'].touched">
                Please enter a valid URL
              </div>
            </div>
          </div>

          <!-- Description -->
          <div class="mb-3">
            <label for="description" class="form-label fw-semibold">Description</label>
            <textarea class="form-control" id="description" formControlName="description" rows="3"
              placeholder="Brief description about your restaurant"></textarea>
          </div>

          <div class="row">

            <!-- Verification Status -->
            <div class="mb-3 col-md-6">
              <label for="isVerified" class="form-label fw-semibold">
                Verification Status <span class="text-danger">*</span>
              </label>

              <select class="form-select" id="isVerified" formControlName="isVerified"
                [class.is-invalid]="f['isVerified'].invalid && f['isVerified'].touched">

                <option value="">Select Status</option>
                <option [value]="true">Verified</option>
                <option [value]="false">Not Verified</option>

              </select>

              <div class="invalid-feedback">
                Please select verification status
              </div>
            </div>

            <!-- Verified By -->
            <div class="mb-3 col-md-6">
              <label for="verifiedBy" class="form-label fw-semibold">
                Verified By <span class="text-danger">*</span>
              </label>

              <input type="text" class="form-control" id="verifiedBy" formControlName="verifiedBy"
                placeholder="Admin / System" [class.is-invalid]="f['verifiedBy'].invalid && f['verifiedBy'].touched" />

              <div class="invalid-feedback">
                Verified By is required
              </div>
            </div>

          </div>



        </form>
      </div>

      <!-- Modal Footer -->
      <div class="modal-footer bg-light">
        <button type="button" class="btn btn-secondary" (click)="onCancel()">
          <i class="bi bi-x-circle me-1"></i> Cancel
        </button>
        <button type="button" class="btn btn-warning" (click)="onReset()">
          <i class="bi bi-arrow-clockwise me-1"></i> Reset
        </button>
        <button type="submit" class="btn btn-primary" (click)="onSubmitRestaurant()"
          [disabled]="restaurantForm.invalid">
          <i class="bi bi-check-circle me-1"></i>
          {{ formMode === 'add' ? 'Add Restaurant' : 'Update Restaurant' }}
        </button>
      </div>

    </div>
  </div>
</div>